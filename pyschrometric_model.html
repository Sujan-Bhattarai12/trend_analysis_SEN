<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sujan Bhattarai">

<title>logistic_regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="pyschrometric_model_files/libs/clipboard/clipboard.min.js"></script>
<script src="pyschrometric_model_files/libs/quarto-html/quarto.js"></script>
<script src="pyschrometric_model_files/libs/quarto-html/popper.min.js"></script>
<script src="pyschrometric_model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pyschrometric_model_files/libs/quarto-html/anchor.min.js"></script>
<link href="pyschrometric_model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pyschrometric_model_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pyschrometric_model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pyschrometric_model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pyschrometric_model_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">logistic_regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sujan Bhattarai </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="running-code" class="level2">
<h2 class="anchored" data-anchor-id="running-code">Running Code</h2>
<p>This is end to End project on classifying precipitation phase using Logistic regression, statistical analysis, and change point detection. The file tree is located in README.md. The orginal data will not be shared in the github, considering github is public platform and data used is highly sensitive. However, the format of data used, and its sample is included in README so that it can be reproduced with ease .</p>
</section>
<section id="things-before-you-begin" class="level2">
<h2 class="anchored" data-anchor-id="things-before-you-begin">things before you begin</h2>
<p>to install CRHMr package for updated R, you first need these packages install.packages(c(“operators”, “topmodel”, “DEoptim”, “XML”)) the installation of CRHMr package requires download of Ecohydrology package install.packages(“devtools”) #library(devtools) #install_github(“CentreForHydrology/CRHMr”)<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load all required packages that will be used for analysis</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CRHMr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(trend)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(changepoint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Successfully loaded changepoint package version 2.2.4
 See NEWS for details of changes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mblm)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:pracma':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
######################### Warning from 'xts' package ##########################
#                                                                             #
# The dplyr lag() function breaks how base R's lag() function is supposed to  #
# work, which breaks lag(my_xts). Calls to lag(my_xts) that you type or       #
# source() into this session won't work correctly.                            #
#                                                                             #
# Use stats::lag() to make sure you're not using dplyr::lag(), or you can add #
# conflictRules('dplyr', exclude = 'lag') to your .Rprofile to stop           #
# dplyr from breaking base R's lag() function.                                #
#                                                                             #
# Code in packages is not affected. It's protected by R's namespace mechanism #
# Set `options(xts.warn_dplyr_breaks_lag = FALSE)` to suppress this warning.  #
#                                                                             #
###############################################################################</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xts'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    first, last</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/sujanbhattarai/Desktop/paras-daiwork/PhaseChange</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set the path for plots so that all plots are saved inside `plots` folder</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plot_path <span class="ot">=</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">'plots'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#constuct file path using here package</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>climate_data <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"climate_data.obs"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>climate_data <span class="ot">&lt;-</span> <span class="fu">readObsFile</span>(climate_data, <span class="at">timezone =</span> <span class="st">'MST'</span>, <span class="at">quiet =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               summary                        value
1   Time step (hours):                            1
2          Total rows:                       350638
3       Complete rows:                       350638
4                From:                   1979-01-01
5                  To:                   2019-01-01
6 First complete date:                   1979-01-01
7  Last complete date:                   2019-01-01
8 Number of variables:                            6
9      Variable names: t.1 ea.1 u.1 Qsi.1 Qli.1 p.1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#multiply wind variable for air speed at height of 5m from the ground</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>climate_data<span class="sc">$</span>u<span class="fl">.1</span> <span class="ot">&lt;-</span> climate_data<span class="sc">$</span>u<span class="fl">.1</span> <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Obs_Data is specific to CRHM package, so the the code below automatically chose</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Ea to change to Relative humidity, and select onlly the required columns</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>climate_data     <span class="ot">&lt;-</span> <span class="fu">changeEatoRH</span>(climate_data)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>climate_data     <span class="ot">&lt;-</span> <span class="fu">subset</span>(climate_data, <span class="at">select =</span> <span class="fu">c</span>(datetime, t<span class="fl">.1</span>, rh<span class="fl">.1</span>, u<span class="fl">.1</span>, p<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#phaseCorrect function partitions based on the temp</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>climate_partitioned <span class="ot">&lt;-</span> <span class="fu">phaseCorrect</span>(climate_data, <span class="at">Tcol =</span> <span class="dv">1</span>, <span class="at">RHcol =</span> <span class="dv">2</span>, <span class="at">Ucol =</span> <span class="dv">3</span>, <span class="at">Pcol =</span> <span class="dv">4</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">shield =</span> <span class="dv">0</span>, <span class="at">quiet =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time interval: 1 hours
Model time step: 2
b: 2.50286
c: 0.125006
               summary
1   Time step (hours):
2          Total rows:
3       Complete rows:
4                From:
5                  To:
6 First complete date:
7  Last complete date:
8 Number of variables:
9      Variable names:
                                                                                             value
1                                                                                                1
2                                                                                           350638
3                                                                                           160422
4                                                                                       1979-01-01
5                                                                                       2019-01-01
6                                                                                       1979-01-04
7                                                                                       2018-12-18
8                                                                                                8
9 t.1 rh.1 u.1 p.1 phaseCorrectRain phaseCorrectSnow phaseCorrectTotalPrecip phaseCorrectRainRatio</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make new columns for months and days, add seasons to make it easy for  analysis and visualizations </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>climate_cleaned <span class="ot">&lt;-</span> climate_partitioned <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">phaseCorrectRainRatio=</span> <span class="fu">round</span>(phaseCorrectRainRatio, <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">year=</span> <span class="fu">year</span>(datetime),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">month=</span> <span class="fu">month</span>(datetime, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">day=</span> <span class="fu">day</span>(datetime),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">period=</span> <span class="fu">if_else</span>(<span class="fu">hour</span>(datetime)<span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span> <span class="fu">hour</span>(datetime)<span class="sc">&lt;</span> <span class="dv">19</span>, <span class="st">"Day"</span>, <span class="st">"Night"</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">season =</span> <span class="fu">ifelse</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>               month <span class="sc">&lt;=</span> <span class="st">"Feb"</span>  <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Dec"</span>, <span class="st">"winter"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>( month <span class="sc">==</span> <span class="st">"Mar"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Apr"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"May"</span>, <span class="st">"pre_monsoon"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(month <span class="sc">==</span> <span class="st">"Oct"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Nov"</span>, <span class="st">"post_monsoon"</span>, <span class="st">"monsoon"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="dv">2019</span> <span class="sc">&amp;</span> p<span class="fl">.1</span> <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">##duplicate copy, the original data is often required in later stage</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>clone_copy <span class="ot">&lt;-</span> climate_partitioned <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">phaseCorrectRainRatio=</span> <span class="fu">round</span>(phaseCorrectRainRatio, <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">year=</span> <span class="fu">year</span>(datetime),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">month=</span> <span class="fu">month</span>(datetime, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">day=</span> <span class="fu">day</span>(datetime),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">period=</span> <span class="fu">if_else</span>(<span class="fu">hour</span>(datetime)<span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span> <span class="fu">hour</span>(datetime)<span class="sc">&lt;</span> <span class="dv">19</span>, <span class="st">"Day"</span>, <span class="st">"Night"</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">season =</span> <span class="fu">ifelse</span>(</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>               month <span class="sc">&lt;=</span> <span class="st">"Feb"</span>  <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Dec"</span>, <span class="st">"winter"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>( month <span class="sc">==</span> <span class="st">"Mar"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Apr"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"May"</span>, <span class="st">"pre_monsoon"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(month <span class="sc">==</span> <span class="st">"Oct"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Nov"</span>, <span class="st">"post_monsoon"</span>, <span class="st">"monsoon"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### summarized yearly data for exponential moving average</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>moving_average <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarize</span>(<span class="at">temp=</span> <span class="fu">mean</span>(t<span class="fl">.1</span>), <span class="at">rh=</span> <span class="fu">mean</span>(rh<span class="fl">.1</span>), <span class="at">wind=</span><span class="fu">mean</span>(u<span class="fl">.1</span>), <span class="at">precip=</span><span class="fu">sum</span>(p<span class="fl">.1</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">rain_ratio=</span> <span class="fu">mean</span>(phaseCorrectRainRatio)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for each variable run the function and store the variable</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># type 'e' is used for exponential weighted average</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>temp_ema        <span class="ot">&lt;-</span> <span class="fu">movavg</span>(moving_average<span class="sc">$</span>temp,       <span class="at">n=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">'e'</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>rh_ema          <span class="ot">&lt;-</span> <span class="fu">movavg</span>(moving_average<span class="sc">$</span>rh,         <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>wind_ema        <span class="ot">&lt;-</span> <span class="fu">movavg</span>(moving_average<span class="sc">$</span>wind,       <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>precip_ema      <span class="ot">&lt;-</span> <span class="fu">movavg</span>(moving_average<span class="sc">$</span>precip,     <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>rain_ratio_ema  <span class="ot">&lt;-</span> <span class="fu">movavg</span>(moving_average<span class="sc">$</span>rain_ratio, <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">###smoother precipitation curve as it shows cyclicity</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesforecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'bayesforecast':
  method      from    
  autoplot.ts forecast
  forecast.ts forecast
  fortify.ts  forecast
  print.garch tseries </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'bayesforecast'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    beta, gamma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggacf</span>(moving_average<span class="sc">$</span>precip_ema, <span class="at">title =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cyclicity is observed in the data, so remove that by subtracting</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>moving_average<span class="sc">$</span>smooth_precip <span class="ot">&lt;-</span> moving_average<span class="sc">$</span>precip <span class="sc">-</span> moving_average<span class="sc">$</span>precip_ema</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggacf</span>(moving_average<span class="sc">$</span>smooth_precip, <span class="at">title =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">###trend test for all variables</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(moving_average<span class="sc">$</span>temp_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  moving_average$temp_ema
z = 6.9324, n = 40, p-value = 4.139e-12
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 596.0000000 7366.6666667    0.7641026 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(moving_average<span class="sc">$</span>temp_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  moving_average$temp_ema
z = 6.9324, n = 40, p-value = 4.139e-12
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.01790674 0.02428181
sample estimates:
Sen's slope 
 0.02155175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(moving_average<span class="sc">$</span>temp_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  moving_average$temp_ema
U* = 386, p-value = 2.413e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(moving_average<span class="sc">$</span>rh_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  moving_average$rh_ema
z = 2.505, n = 40, p-value = 0.01225
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 216.0000000 7366.6666667    0.2769231 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(moving_average<span class="sc">$</span>rh_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  moving_average$rh_ema
z = 2.505, n = 40, p-value = 0.01225
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.01023207 0.05947579
sample estimates:
Sen's slope 
 0.02721846 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(moving_average<span class="sc">$</span>rh_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  moving_average$rh_ema
U* = 348, p-value = 3.094e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             14 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(moving_average<span class="sc">$</span>wind_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  moving_average$wind_ema
z = -4.6022, n = 40, p-value = 4.181e-06
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
-396.0000000 7366.6666667   -0.5076923 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(moving_average<span class="sc">$</span>wind_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  moving_average$wind_ema
z = -4.6022, n = 40, p-value = 4.181e-06
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.007121856 -0.003655108
sample estimates:
 Sen's slope 
-0.005428641 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(moving_average<span class="sc">$</span>wind_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  moving_average$wind_ema
U* = 317, p-value = 0.0002039
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(moving_average<span class="sc">$</span>smooth_precip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  moving_average$smooth_precip
z = -0.43109, n = 40, p-value = 0.6664
alternative hypothesis: true S is not equal to 0
sample estimates:
            S          varS           tau 
 -38.00000000 7366.66666667   -0.04871795 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(moving_average<span class="sc">$</span>smooth_precip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  moving_average$smooth_precip
z = -0.43109, n = 40, p-value = 0.6664
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -3.822617  2.640772
sample estimates:
Sen's slope 
  -0.959712 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(moving_average<span class="sc">$</span>smooth_precip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  moving_average$smooth_precip
U* = 117, p-value = 0.5718
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                              5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(moving_average<span class="sc">$</span>rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  moving_average$rain_ratio_ema
z = 4.9284, n = 40, p-value = 8.291e-07
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 424.0000000 7366.6666667    0.5435897 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(moving_average<span class="sc">$</span>rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  moving_average$rain_ratio_ema
z = 4.9284, n = 40, p-value = 8.291e-07
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0009512447 0.0018916136
sample estimates:
Sen's slope 
0.001390375 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(moving_average<span class="sc">$</span>rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  moving_average$rain_ratio_ema
U* = 368, p-value = 8.35e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create slope values for sen's slopem </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this value will be used in next plot</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>mkmodel_temp     <span class="ot">&lt;-</span> <span class="fu">mblm</span>(temp_ema <span class="sc">~</span> year, <span class="at">data=</span>moving_average)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>mkmodel_wind     <span class="ot">&lt;-</span> <span class="fu">mblm</span>(wind_ema <span class="sc">~</span> year, <span class="at">data=</span>moving_average)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>mkmodel_rh       <span class="ot">&lt;-</span> <span class="fu">mblm</span>(rh_ema <span class="sc">~</span> year, <span class="at">data=</span>moving_average)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>mkmodel_precip   <span class="ot">&lt;-</span> <span class="fu">mblm</span>(precip_ema <span class="sc">~</span> year, <span class="at">data=</span>moving_average)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>mkmodel_smoother <span class="ot">&lt;-</span> <span class="fu">mblm</span>(smooth_precip <span class="sc">~</span> year, <span class="at">data=</span>moving_average)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">###legend color, manual color setup, often this can be used upon</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#multiples graphs</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"variable_color"</span><span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"weight_color"</span><span class="ot">=</span><span class="st">"lightblue"</span>, <span class="st">'abline_color'</span><span class="ot">=</span> <span class="st">'red'</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare graphs</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>make_graph <span class="ot">&lt;-</span> <span class="cf">function</span>(type, variable, weight, xlab, ylab, mkmodel, <span class="at">legend.position=</span><span class="st">"FALSE"</span>) {</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> moving_average <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, {{variable}})) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> moving_average, <span class="fu">aes</span>(year, {{weight}}, <span class="at">color =</span> <span class="st">'col2'</span>)) <span class="sc">+</span> </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span> moving_average, <span class="fu">aes</span>(year, {{weight}}, <span class="at">color=</span> <span class="st">"col2"</span>))<span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(mkmodel)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(mkmodel)[<span class="dv">2</span>] ) <span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1979</span>, <span class="dv">2019</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> legend.position) <span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'col2'</span> <span class="ot">=</span> <span class="st">'#E69F00'</span>))</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">identical</span>(type, geom_bar)) {</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">type</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"col1"</span>)) <span class="sc">+</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'col1'</span> <span class="ot">=</span> <span class="st">'#0072B2'</span>, <span class="st">'col2'</span> <span class="ot">=</span> <span class="st">'#E69F00'</span>))</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> plot <span class="sc">+</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(mkmodel)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(mkmodel)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/trend_test.tiff"</span>,  <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">make_graph</span>( <span class="at">type =</span> geom_line, <span class="at">variable=</span> temp,    <span class="at">weight =</span> temp_ema,   <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Temperature °C"</span>,  <span class="at">mkmodel=</span> mkmodel_temp),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">make_graph</span>( <span class="at">type =</span> geom_line, <span class="at">variable=</span> wind,    <span class="at">weight =</span> wind_ema,   <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Wind (ms"</span><span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">")"</span>), <span class="at">mkmodel=</span> mkmodel_wind),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">make_graph</span>( <span class="at">type =</span> geom_step, <span class="at">variable=</span> rh,     <span class="at">weight =</span> rh_ema,     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab =</span>  <span class="st">"Relative Humidity (%)"</span>, <span class="at">mkmodel=</span> mkmodel_rh),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">make_graph</span>( <span class="at">type =</span> geom_bar,  <span class="at">variable =</span>smooth_precip, <span class="at">weight =</span> precip_ema, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Precipitation (mm)"</span>), <span class="at">mkmodel=</span>mkmodel_smoother))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.
Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.
Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/temp.tiff"</span>,  <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>( <span class="at">type =</span> geom_line, <span class="at">variable=</span> temp,    <span class="at">weight =</span> temp_ema,   <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Temperature °C"</span>,  <span class="at">mkmodel=</span> mkmodel_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Do MK trend test, Sen's slope in all ema columns</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>calculate_mk_test <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(data) <span class="sc">==</span> <span class="st">"temp_ema"</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  end   <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(data) <span class="sc">==</span> <span class="st">"rain_ratio_ema"</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  mk_sen_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> start<span class="sc">:</span>end) {</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    column <span class="ot">&lt;-</span> data[[i]]</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    mk <span class="ot">&lt;-</span> <span class="fu">mk.test</span>(column)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    sen <span class="ot">&lt;-</span> <span class="fu">sens.slope</span>(column)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    petite <span class="ot">&lt;-</span> <span class="fu">pettitt.test</span>(column)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    mk_sen_results[[<span class="fu">colnames</span>(data)[i]]] <span class="ot">&lt;-</span> <span class="fu">list</span>(mk, sen, petite )</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mk_sen_results)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="fu">calculate_mk_test</span>(moving_average)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$temp_ema
$temp_ema[[1]]

    Mann-Kendall trend test

data:  column
z = 6.9324, n = 40, p-value = 4.139e-12
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 596.0000000 7366.6666667    0.7641026 


$temp_ema[[2]]

    Sen's slope

data:  column
z = 6.9324, n = 40, p-value = 4.139e-12
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.01790674 0.02428181
sample estimates:
Sen's slope 
 0.02155175 


$temp_ema[[3]]

    Pettitt's test for single change-point detection

data:  column
U* = 386, p-value = 2.413e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             20 



$rh_ema
$rh_ema[[1]]

    Mann-Kendall trend test

data:  column
z = 2.505, n = 40, p-value = 0.01225
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 216.0000000 7366.6666667    0.2769231 


$rh_ema[[2]]

    Sen's slope

data:  column
z = 2.505, n = 40, p-value = 0.01225
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.01023207 0.05947579
sample estimates:
Sen's slope 
 0.02721846 


$rh_ema[[3]]

    Pettitt's test for single change-point detection

data:  column
U* = 348, p-value = 3.094e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             14 



$wind_ema
$wind_ema[[1]]

    Mann-Kendall trend test

data:  column
z = -4.6022, n = 40, p-value = 4.181e-06
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
-396.0000000 7366.6666667   -0.5076923 


$wind_ema[[2]]

    Sen's slope

data:  column
z = -4.6022, n = 40, p-value = 4.181e-06
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.007121856 -0.003655108
sample estimates:
 Sen's slope 
-0.005428641 


$wind_ema[[3]]

    Pettitt's test for single change-point detection

data:  column
U* = 317, p-value = 0.0002039
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 



$precip_ema
$precip_ema[[1]]

    Mann-Kendall trend test

data:  column
z = 0.43109, n = 40, p-value = 0.6664
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
3.800000e+01 7.366667e+03 4.871795e-02 


$precip_ema[[2]]

    Sen's slope

data:  column
z = 0.43109, n = 40, p-value = 0.6664
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -2.314116  5.041670
sample estimates:
Sen's slope 
  0.8953558 


$precip_ema[[3]]

    Pettitt's test for single change-point detection

data:  column
U* = 186, p-value = 0.08449
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             12 



$rain_ratio_ema
$rain_ratio_ema[[1]]

    Mann-Kendall trend test

data:  column
z = 4.9284, n = 40, p-value = 8.291e-07
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 424.0000000 7366.6666667    0.5435897 


$rain_ratio_ema[[2]]

    Sen's slope

data:  column
z = 4.9284, n = 40, p-value = 8.291e-07
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0009512447 0.0018916136
sample estimates:
Sen's slope 
0.001390375 


$rain_ratio_ema[[3]]

    Pettitt's test for single change-point detection

data:  column
U* = 368, p-value = 8.35e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar = c(1, 1, 1, 1)) # this is used to set the graphical plot window: not a part of climate analysis</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cpt.meanvar(annual_mean$annual_average, method="AMOC", minseglen = 10) # this test identifies the change point using AMOC</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the code below this point test the same thing for annual daytime and nighttime</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filtering data only for days(6am and 6pm) requred in model fitting in next step</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>annual_Day <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( period<span class="sc">==</span><span class="st">"Day"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rain_ratio=</span> <span class="fu">mean</span>(phaseCorrectRainRatio)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_rain_ratio_ema =</span> <span class="fu">movavg</span>( rain_ratio, <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)) </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(annual_Day<span class="sc">$</span>day_rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  annual_Day$day_rain_ratio_ema
z = 5.4177, n = 40, p-value = 6.036e-08
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 466.0000000 7366.6666667    0.5974359 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(annual_Day<span class="sc">$</span>day_rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  annual_Day$day_rain_ratio_ema
z = 5.4177, n = 40, p-value = 6.036e-08
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.001253790 0.002368411
sample estimates:
Sen's slope 
  0.0017924 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(annual_Day<span class="sc">$</span>day_rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  annual_Day$day_rain_ratio_ema
U* = 368, p-value = 8.35e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cpt.meanvar</span>(annual_Day<span class="sc">$</span>day_rain_ratio_ema, <span class="at">method=</span><span class="st">"AMOC"</span>, <span class="at">minseglen =</span> <span class="dv">10</span>)<span class="co"># identifies changepoint</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">param.est</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mean
[1] 0.6809435 0.7250185

$variance
[1] 0.0004474687 0.0003826883</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### for night period</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>annual_Night <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( period<span class="sc">==</span><span class="st">"Night"</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rain_ratio=</span> <span class="fu">mean</span>(phaseCorrectRainRatio)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">night_rain_ratio_ema =</span> <span class="fu">movavg</span>(rain_ratio, <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mk.test</span>(annual_Night<span class="sc">$</span>night_rain_ratio_ema) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mann-Kendall trend test

data:  annual_Night$night_rain_ratio_ema
z = 3.5303, n = 40, p-value = 0.0004151
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 304.0000000 7366.6666667    0.3897436 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sens.slope</span>(annual_Night<span class="sc">$</span>night_rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Sen's slope

data:  annual_Night$night_rain_ratio_ema
z = 3.5303, n = 40, p-value = 0.0004151
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0005336645 0.0015619942
sample estimates:
Sen's slope 
0.001046205 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pettitt.test</span>(annual_Night<span class="sc">$</span>night_rain_ratio_ema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pettitt's test for single change-point detection

data:  annual_Night$night_rain_ratio_ema
U* = 343, p-value = 4.244e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             15 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cpt.meanvar</span>(annual_Night<span class="sc">$</span>night_rain_ratio_ema, <span class="at">method=</span><span class="st">"AMOC"</span>, <span class="at">minseglen =</span> <span class="dv">10</span>)<span class="co"># identifies changepoint</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">param.est</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mean
[1] 0.5408739 0.5805139

$variance
[1] 0.0007946858 0.0001063264</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot does not have readymade function for sens slope.. so manual model is created for day and night</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so that it can be used in visualization part</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>mkmodel1 <span class="ot">&lt;-</span> <span class="fu">mblm</span>(day_rain_ratio_ema <span class="sc">~</span> year, <span class="at">data=</span>annual_Day) <span class="co">#for day </span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>mkmodel2 <span class="ot">&lt;-</span> <span class="fu">mblm</span>(night_rain_ratio_ema <span class="sc">~</span> year, <span class="at">data=</span>annual_Night) <span class="co">#for night</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># this data is required for plotting for day and night averages</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>annual_mean <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, period) <span class="sc">%&gt;%</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p<span class="fl">.1</span> <span class="sc">!=</span> <span class="dv">0</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">annual_average=</span> <span class="fu">mean</span>(phaseCorrectRainRatio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting trend#for annual day and night</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(annual_mean, <span class="fu">aes</span>(year, annual_average, <span class="at">color=</span> period))<span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(mkmodel1)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(mkmodel1)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">'#0072B2'</span>)<span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(mkmodel2)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(mkmodel2)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">'#0072B2'</span>)<span class="sc">+</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Annual rainfall ratio"</span>)<span class="sc">+</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.25</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1979</span>, <span class="dv">2019</span>, <span class="at">by =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>annual_Day, <span class="fu">aes</span>(year, day_rain_ratio_ema), <span class="at">color=</span><span class="st">"deeppink"</span>)<span class="sc">+</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = 1999, y = 0.25, label = "sen's slope for diurnal period= 0.0014, p value= 0.02", size= 4)+</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span>annual_Night, <span class="fu">aes</span>(year, night_rain_ratio_ema), <span class="at">color=</span><span class="st">"deeppink"</span>)<span class="sc">+</span>  <span class="co">#454545</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = 1999, y = 0.3, label = "sen's slope for night period= 0.0008, p value= 0.2", size= 4)+</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="st">""</span>, <span class="at">values=</span>colors)<span class="sc">+</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'col1'</span> <span class="ot">=</span> <span class="st">'#0072B2'</span>, <span class="st">'col2'</span> <span class="ot">=</span> <span class="st">'#E69F00'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.
No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plots/day-and-night.tiff"</span>, <span class="at">height=</span><span class="dv">5</span>, <span class="at">width=</span><span class="dv">4</span>) <span class="co"># saves the previously created ggplot graphics in high quality</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.
No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for august and for all other months</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#caluculating rainfall ratio trend for aug</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for other months, need to change month value to different one</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>monthwise_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(month <span class="sc">==</span> x <span class="sc">&amp;</span>  period<span class="sc">==</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, month, period) <span class="sc">%&gt;%</span> </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(phaseCorrectRainRatio)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mean_ema =</span> <span class="fu">movavg</span>(mean, <span class="at">n=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'e'</span>)) </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(filtered_data, <span class="fu">mk.test</span>(filtered_data<span class="sc">$</span>mean_ema), <span class="fu">sens.slope</span>(filtered_data<span class="sc">$</span>mean_ema),</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">pettitt.test</span>(filtered_data<span class="sc">$</span>mean_ema), <span class="fu">param.est</span>(<span class="fu">cpt.meanvar</span>(filtered_data<span class="sc">$</span>mean_ema, <span class="at">method=</span><span class="st">"AMOC"</span>, <span class="at">minseglen =</span> <span class="dv">10</span>)) ))</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jan"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 37 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jan   Day        0        0
 2  1980 Jan   Day        0        0
 3  1981 Jan   Day        0        0
 4  1982 Jan   Day        0        0
 5  1983 Jan   Day        0        0
 6  1984 Jan   Day        0        0
 7  1985 Jan   Day        0        0
 8  1986 Jan   Day        0        0
 9  1987 Jan   Day        0        0
10  1988 Jan   Day        0        0
# ℹ 27 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = -0.47763, n = 37, p-value = 0.6329
alternative hypothesis: true S is not equal to 0
sample estimates:
            S          varS           tau 
 -37.00000000 5681.00000000   -0.05800214 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = -0.47763, n = 37, p-value = 0.6329
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -4.329419e-07  2.259132e-09
sample estimates:
Sen's slope 
          0 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 286, p-value = 0.0001599
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             11 


[[5]]
[[5]]$mean
[1] 5.175692e-05 6.032546e-07

[[5]]$variance
[1] 7.125528e-09 5.230504e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Feb"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 38 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Feb   Day        0        0
 2  1980 Feb   Day        0        0
 3  1981 Feb   Day        0        0
 4  1982 Feb   Day        0        0
 5  1983 Feb   Day        0        0
 6  1984 Feb   Day        0        0
 7  1985 Feb   Day        0        0
 8  1986 Feb   Day        0        0
 9  1987 Feb   Day        0        0
10  1988 Feb   Day        0        0
# ℹ 28 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.5188, n = 38, p-value = 0.01177
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 196.0000000 5993.3333333    0.2988152 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.5188, n = 38, p-value = 0.01177
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.000000e+00 7.827879e-06
sample estimates:
 Sen's slope 
3.147718e-06 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 336, p-value = 1.195e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             14 


[[5]]
[[5]]$mean
[1] 0.0000000000 0.0002767242

[[5]]$variance
[1] 0.000000e+00 3.949226e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Mar"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period     mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Mar   Day    0.000159 0.000159
 2  1980 Mar   Day    0        0.000106
 3  1981 Mar   Day    0.00314  0.00112 
 4  1982 Mar   Day    0.00778  0.00334 
 5  1983 Mar   Day    0.000435 0.00237 
 6  1984 Mar   Day    0.118    0.0411  
 7  1985 Mar   Day    0.0138   0.0320  
 8  1986 Mar   Day    0        0.0213  
 9  1987 Mar   Day    0.0369   0.0265  
10  1988 Mar   Day    0        0.0177  
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.2253, n = 40, p-value = 0.02606
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 192.0000000 7366.6666667    0.2461538 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.2253, n = 40, p-value = 0.02606
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0001151312 0.0008043902
sample estimates:
 Sen's slope 
0.0004462775 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 225, p-value = 0.0195
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             15 


[[5]]
[[5]]$mean
[1] 0.02419907

[[5]]$variance
[1] 0.0003142598</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Apr"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Apr   Day    0.184    0.184
 2  1980 Apr   Day    0.268    0.212
 3  1981 Apr   Day    0.355    0.260
 4  1982 Apr   Day    0.140    0.220
 5  1983 Apr   Day    0.151    0.197
 6  1984 Apr   Day    0.192    0.195
 7  1985 Apr   Day    0.338    0.243
 8  1986 Apr   Day    0.118    0.201
 9  1987 Apr   Day    0.138    0.180
10  1988 Apr   Day    0.176    0.179
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.3419, n = 40, p-value = 0.01919
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 202.0000000 7366.6666667    0.2589744 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.3419, n = 40, p-value = 0.01919
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.000309825 0.003162061
sample estimates:
Sen's slope 
0.001769415 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 295, p-value = 0.0006986
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             21 


[[5]]
[[5]]$mean
[1] 0.1873154 0.2547889

[[5]]$variance
[1] 0.001046581 0.002431502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"May"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 May   Day    0.806    0.806
 2  1980 May   Day    0.696    0.770
 3  1981 May   Day    0.716    0.752
 4  1982 May   Day    0.641    0.715
 5  1983 May   Day    0.625    0.685
 6  1984 May   Day    0.782    0.717
 7  1985 May   Day    0.737    0.724
 8  1986 May   Day    0.561    0.670
 9  1987 May   Day    0.504    0.614
10  1988 May   Day    0.789    0.673
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 0.99034, n = 40, p-value = 0.322
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
  86.0000000 7366.6666667    0.1102564 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 0.99034, n = 40, p-value = 0.322
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.0005919162  0.0016300767
sample estimates:
Sen's slope 
0.000534731 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 208, p-value = 0.03824
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 


[[5]]
[[5]]$mean
[1] 0.7221465

[[5]]$variance
[1] 0.001301978</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jun"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jun   Day    0.925    0.925
 2  1980 Jun   Day    0.924    0.924
 3  1981 Jun   Day    0.926    0.925
 4  1982 Jun   Day    0.895    0.915
 5  1983 Jun   Day    0.843    0.891
 6  1984 Jun   Day    0.960    0.914
 7  1985 Jun   Day    0.889    0.905
 8  1986 Jun   Day    0.358    0.723
 9  1987 Jun   Day    0.878    0.775
10  1988 Jun   Day    0.878    0.809
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 3.0642, n = 40, p-value = 0.002182
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 264.0000000 7366.6666667    0.3384615 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 3.0642, n = 40, p-value = 0.002182
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0002388902 0.0015994686
sample estimates:
 Sen's slope 
0.0008399705 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 308, p-value = 0.0003411
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             20 


[[5]]
[[5]]$mean
[1] 0.8768385 0.9212176

[[5]]$variance
[1] 2.780797e-03 2.985449e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jul"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jul   Day    0.972    0.972
 2  1980 Jul   Day    0.987    0.977
 3  1981 Jul   Day    0.987    0.980
 4  1982 Jul   Day    0.980    0.980
 5  1983 Jul   Day    0.944    0.968
 6  1984 Jul   Day    0.980    0.972
 7  1985 Jul   Day    0.950    0.965
 8  1986 Jul   Day    0.334    0.754
 9  1987 Jul   Day    0.964    0.824
10  1988 Jul   Day    0.986    0.878
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 1.8758, n = 40, p-value = 0.06068
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 162.0000000 7366.6666667    0.2076923 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 1.8758, n = 40, p-value = 0.06068
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.0000102805  0.0007787939
sample estimates:
 Sen's slope 
0.0002676427 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 264, p-value = 0.003408
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             18 


[[5]]
[[5]]$mean
[1] 0.9293460 0.9752049

[[5]]$variance
[1] 4.244757e-03 3.879712e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Aug"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Aug   Day    0.941    0.941
 2  1980 Aug   Day    0.975    0.952
 3  1981 Aug   Day    0.968    0.957
 4  1982 Aug   Day    0.976    0.964
 5  1983 Aug   Day    0.950    0.959
 6  1984 Aug   Day    0.923    0.947
 7  1985 Aug   Day    0.982    0.959
 8  1986 Aug   Day    0.958    0.959
 9  1987 Aug   Day    0.919    0.945
10  1988 Aug   Day    0.976    0.956
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 5.9304, n = 40, p-value = 3.022e-09
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 510.0000000 7366.6666667    0.6538462 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 5.9304, n = 40, p-value = 3.022e-09
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.0007104811 0.0011050136
sample estimates:
 Sen's slope 
0.0009288176 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 379, p-value = 3.938e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K                            &lt;NA&gt; 
                             17                              19 


[[5]]
[[5]]$mean
[1] 0.9556842 0.9750562

[[5]]$variance
[1] 4.765227e-05 4.031308e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Sep"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Sep   Day    0.892    0.892
 2  1980 Sep   Day    0.939    0.908
 3  1981 Sep   Day    0.918    0.911
 4  1982 Sep   Day    0.891    0.905
 5  1983 Sep   Day    0.930    0.913
 6  1984 Sep   Day    0.930    0.919
 7  1985 Sep   Day    0.908    0.915
 8  1986 Sep   Day    0.878    0.903
 9  1987 Sep   Day    0.901    0.902
10  1988 Sep   Day    0.907    0.904
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.3419, n = 40, p-value = 0.01919
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 202.0000000 7366.6666667    0.2589744 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.3419, n = 40, p-value = 0.01919
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 4.676159e-05 5.957547e-04
sample estimates:
 Sen's slope 
0.0003367713 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 263, p-value = 0.003577
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             15 


[[5]]
[[5]]$mean
[1] 0.9159204

[[5]]$variance
[1] 9.816127e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Oct"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 39 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Oct   Day    0.433    0.433
 2  1980 Oct   Day    0.320    0.395
 3  1981 Oct   Day    0.606    0.466
 4  1982 Oct   Day    0.187    0.373
 5  1983 Oct   Day    0.577    0.441
 6  1984 Oct   Day    0.692    0.525
 7  1985 Oct   Day    0.448    0.499
 8  1986 Oct   Day    0.197    0.398
 9  1987 Oct   Day    0.341    0.379
10  1988 Oct   Day    0.443    0.400
# ℹ 29 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 3, n = 39, p-value = 0.0027
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 249.0000000 6833.6666667    0.3360324 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 3, n = 39, p-value = 0.0027
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.001280663 0.005457376
sample estimates:
Sen's slope 
0.003448929 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 270, p-value = 0.001509
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             13 


[[5]]
[[5]]$mean
[1] 0.4277332 0.5304438

[[5]]$variance
[1] 0.002212934 0.003532080</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Nov"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 33 × 5
    year month period     mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Nov   Day    0.0268    0.0268 
 2  1980 Nov   Day    0.0120    0.0218 
 3  1981 Nov   Day    0.0193    0.0210 
 4  1982 Nov   Day    0.00637   0.0161 
 5  1983 Nov   Day    0.000333  0.0109 
 6  1984 Nov   Day    0         0.00724
 7  1985 Nov   Day    0.0210    0.0118 
 8  1986 Nov   Day    0.0129    0.0122 
 9  1987 Nov   Day    0         0.00812
10  1988 Nov   Day    0         0.00541
# ℹ 23 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 3.1454, n = 33, p-value = 0.001659
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 204.0000000 4165.3333333    0.3863636 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 3.1454, n = 33, p-value = 0.001659
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.001147359 0.004193464
sample estimates:
Sen's slope 
0.002700871 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 272, p-value = 1.242e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             17 


[[5]]
[[5]]$mean
[1] 0.01422831 0.09318854

[[5]]$variance
[1] 7.172363e-05 8.417790e-04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Dec"</span>, <span class="st">"Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 36 × 5
    year month period     mean  mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  1979 Dec   Day    0        0        
 2  1980 Dec   Day    0        0        
 3  1981 Dec   Day    0        0        
 4  1982 Dec   Day    0        0        
 5  1983 Dec   Day    0        0        
 6  1984 Dec   Day    0.000638 0.000213 
 7  1985 Dec   Day    0        0.000142 
 8  1986 Dec   Day    0        0.0000946
 9  1987 Dec   Day    0        0.0000630
10  1988 Dec   Day    0        0.0000420
# ℹ 26 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 1.9781, n = 36, p-value = 0.04792
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 146.0000000 5373.3333333    0.2336075 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 1.9781, n = 36, p-value = 0.04792
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.00000e+00 5.85531e-06
sample estimates:
 Sen's slope 
1.105771e-06 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 267, p-value = 0.0002674
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 


[[5]]
[[5]]$mean
[1] 3.347955e-05 5.321244e-04

[[5]]$variance
[1] 3.167745e-09 4.906163e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jan"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 37 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jan   Night      0        0
 2  1980 Jan   Night      0        0
 3  1981 Jan   Night      0        0
 4  1982 Jan   Night      0        0
 5  1983 Jan   Night      0        0
 6  1984 Jan   Night      0        0
 7  1985 Jan   Night      0        0
 8  1986 Jan   Night      0        0
 9  1987 Jan   Night      0        0
10  1988 Jan   Night      0        0
# ℹ 27 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = NaN, n = 37, p-value = NA
alternative hypothesis: true S is not equal to 0
sample estimates:
   S varS  tau 
   0    0  NaN 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = NaN, n = 37, p-value = NA
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0 0
sample estimates:
Sen's slope 
          0 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 0, p-value = 1
alternative hypothesis: two.sided
sample estimates:
probable change point at time K                            &lt;NA&gt; 
                              1                               2 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              3                               4 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              5                               6 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              7                               8 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              9                              10 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             11                              12 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             13                              14 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             15                              16 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             17                              18 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             19                              20 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             21                              22 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             23                              24 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             25                              26 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             27                              28 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             29                              30 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             31                              32 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             33                              34 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             35                              36 
                           &lt;NA&gt; 
                             37 


[[5]]
[[5]]$mean
[1] 0

[[5]]$variance
[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Feb"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 38 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Feb   Night      0        0
 2  1980 Feb   Night      0        0
 3  1981 Feb   Night      0        0
 4  1982 Feb   Night      0        0
 5  1983 Feb   Night      0        0
 6  1984 Feb   Night      0        0
 7  1985 Feb   Night      0        0
 8  1986 Feb   Night      0        0
 9  1987 Feb   Night      0        0
10  1988 Feb   Night      0        0
# ℹ 28 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = NaN, n = 38, p-value = NA
alternative hypothesis: true S is not equal to 0
sample estimates:
   S varS  tau 
   0    0  NaN 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = NaN, n = 38, p-value = NA
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0 0
sample estimates:
Sen's slope 
          0 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 0, p-value = 1
alternative hypothesis: two.sided
sample estimates:
probable change point at time K                            &lt;NA&gt; 
                              1                               2 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              3                               4 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              5                               6 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              7                               8 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              9                              10 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             11                              12 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             13                              14 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             15                              16 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             17                              18 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             19                              20 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             21                              22 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             23                              24 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             25                              26 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             27                              28 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             29                              30 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             31                              32 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             33                              34 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             35                              36 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             37                              38 


[[5]]
[[5]]$mean
[1] 0

[[5]]$variance
[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Mar"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period     mean  mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  1979 Mar   Night  0        0        
 2  1980 Mar   Night  0        0        
 3  1981 Mar   Night  0        0        
 4  1982 Mar   Night  0        0        
 5  1983 Mar   Night  0        0        
 6  1984 Mar   Night  0.000263 0.0000877
 7  1985 Mar   Night  0        0.0000585
 8  1986 Mar   Night  0        0.0000390
 9  1987 Mar   Night  0        0.0000260
10  1988 Mar   Night  0        0.0000173
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 3.4176, n = 40, p-value = 0.0006317
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 294.0000000 7350.0000000    0.3793627 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 3.4176, n = 40, p-value = 0.0006317
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 1.369705e-06 6.441232e-06
sample estimates:
 Sen's slope 
2.854479e-06 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 325, p-value = 0.0001275
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             15 


[[5]]
[[5]]$mean
[1] 2.592732e-05 2.678801e-04

[[5]]$variance
[1] 7.373442e-10 9.801105e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Apr"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period      mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Apr   Night  0.00506    0.00506
 2  1980 Apr   Night  0.00328    0.00447
 3  1981 Apr   Night  0.00351    0.00415
 4  1982 Apr   Night  0          0.00277
 5  1983 Apr   Night  0.00108    0.00220
 6  1984 Apr   Night  0.000882   0.00176
 7  1985 Apr   Night  0.00909    0.00421
 8  1986 Apr   Night  0.000167   0.00286
 9  1987 Apr   Night  0.0000662  0.00193
10  1988 Apr   Night  0.00112    0.00166
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.0622, n = 40, p-value = 0.03919
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 178.0000000 7366.6666667    0.2282051 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.0622, n = 40, p-value = 0.03919
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 2.329045e-06 1.179127e-04
sample estimates:
 Sen's slope 
5.679043e-05 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 278, p-value = 0.001703
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 


[[5]]
[[5]]$mean
[1] 0.002774721 0.005194864

[[5]]$variance
[1] 1.276670e-06 3.917176e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"May"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period   mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 May   Night  0.222     0.222
 2  1980 May   Night  0.0973    0.181
 3  1981 May   Night  0.147     0.169
 4  1982 May   Night  0.0366    0.125
 5  1983 May   Night  0.0676    0.106
 6  1984 May   Night  0.311     0.174
 7  1985 May   Night  0.139     0.163
 8  1986 May   Night  0.0160    0.114
 9  1987 May   Night  0.0996    0.109
10  1988 May   Night  0.222     0.147
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.5516, n = 40, p-value = 0.01072
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 220.0000000 7366.6666667    0.2820513 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.5516, n = 40, p-value = 0.01072
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.000418345 0.002771350
sample estimates:
Sen's slope 
0.001552632 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 294, p-value = 0.0007372
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             16 


[[5]]
[[5]]$mean
[1] 0.1611015 0.2188621

[[5]]$variance
[1] 0.001101112 0.001231344</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jun"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jun   Night  0.778    0.778
 2  1980 Jun   Night  0.835    0.797
 3  1981 Jun   Night  0.771    0.788
 4  1982 Jun   Night  0.698    0.758
 5  1983 Jun   Night  0.536    0.684
 6  1984 Jun   Night  0.877    0.749
 7  1985 Jun   Night  0.660    0.719
 8  1986 Jun   Night  0.172    0.537
 9  1987 Jun   Night  0.648    0.574
10  1988 Jun   Night  0.631    0.593
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 1.6894, n = 40, p-value = 0.09114
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 146.0000000 7366.6666667    0.1871795 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 1.6894, n = 40, p-value = 0.09114
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.0001296932  0.0031017261
sample estimates:
Sen's slope 
0.001397693 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 243, p-value = 0.009026
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 


[[5]]
[[5]]$mean
[1] 0.6907840 0.7651868

[[5]]$variance
[1] 0.0059388573 0.0006421996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Jul"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Jul   Night  0.952    0.952
 2  1980 Jul   Night  0.978    0.961
 3  1981 Jul   Night  0.981    0.968
 4  1982 Jul   Night  0.968    0.968
 5  1983 Jul   Night  0.890    0.942
 6  1984 Jul   Night  0.961    0.948
 7  1985 Jul   Night  0.887    0.928
 8  1986 Jul   Night  0.207    0.688
 9  1987 Jul   Night  0.944    0.773
10  1988 Jul   Night  0.980    0.842
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 2.202, n = 40, p-value = 0.02766
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 190.0000000 7366.6666667    0.2435897 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 2.202, n = 40, p-value = 0.02766
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 8.030745e-05 1.524302e-03
sample estimates:
 Sen's slope 
0.0006727866 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 276, p-value = 0.001884
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             18 


[[5]]
[[5]]$mean
[1] 0.8986298 0.9571095

[[5]]$variance
[1] 0.006193057 0.000177692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Aug"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Aug   Night  0.858    0.858
 2  1980 Aug   Night  0.943    0.887
 3  1981 Aug   Night  0.945    0.906
 4  1982 Aug   Night  0.956    0.923
 5  1983 Aug   Night  0.894    0.913
 6  1984 Aug   Night  0.780    0.869
 7  1985 Aug   Night  0.957    0.898
 8  1986 Aug   Night  0.892    0.896
 9  1987 Aug   Night  0.826    0.873
10  1988 Aug   Night  0.950    0.898
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 5.3711, n = 40, p-value = 7.825e-08
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 462.0000000 7366.6666667    0.5923077 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 5.3711, n = 40, p-value = 7.825e-08
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.001543072 0.002727062
sample estimates:
Sen's slope 
0.002047942 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 369, p-value = 7.806e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             21 


[[5]]
[[5]]$mean
[1] 0.9079254 0.9527947

[[5]]$variance
[1] 0.0004710678 0.0001967934</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Sep"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Sep   Night  0.600    0.600
 2  1980 Sep   Night  0.708    0.636
 3  1981 Sep   Night  0.564    0.612
 4  1982 Sep   Night  0.514    0.579
 5  1983 Sep   Night  0.799    0.652
 6  1984 Sep   Night  0.703    0.669
 7  1985 Sep   Night  0.624    0.654
 8  1986 Sep   Night  0.491    0.600
 9  1987 Sep   Night  0.665    0.622
10  1988 Sep   Night  0.681    0.641
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 0.68741, n = 40, p-value = 0.4918
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
6.000000e+01 7.366667e+03 7.692308e-02 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 0.68741, n = 40, p-value = 0.4918
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 -0.0007224173  0.0014701522
sample estimates:
 Sen's slope 
0.0003867111 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 202, p-value = 0.04789
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             10 


[[5]]
[[5]]$mean
[1] 0.6587073

[[5]]$variance
[1] 0.00133305</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Oct"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 40 × 5
    year month period     mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Oct   Night  0.0770     0.0770
 2  1980 Oct   Night  0.000563   0.0515
 3  1981 Oct   Night  0.0318     0.0450
 4  1982 Oct   Night  0.000154   0.0300
 5  1983 Oct   Night  0.0668     0.0423
 6  1984 Oct   Night  0.0483     0.0443
 7  1985 Oct   Night  0.0418     0.0435
 8  1986 Oct   Night  0.00423    0.0304
 9  1987 Oct   Night  0.0177     0.0262
10  1988 Oct   Night  0.0429     0.0318
# ℹ 30 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 4.2759, n = 40, p-value = 1.903e-05
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 368.0000000 7366.6666667    0.4717949 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 4.2759, n = 40, p-value = 1.903e-05
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.001142253 0.002745751
sample estimates:
Sen's slope 
0.001969209 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 375, p-value = 5.189e-06
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 


[[5]]
[[5]]$mean
[1] 0.0437565 0.1021342

[[5]]$variance
[1] 0.0001488208 0.0021234646</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Nov"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 31 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Nov   Night      0        0
 2  1980 Nov   Night      0        0
 3  1981 Nov   Night      0        0
 4  1982 Nov   Night      0        0
 5  1983 Nov   Night      0        0
 6  1984 Nov   Night      0        0
 7  1985 Nov   Night      0        0
 8  1986 Nov   Night      0        0
 9  1988 Nov   Night      0        0
10  1989 Nov   Night      0        0
# ℹ 21 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = 3.9863, n = 31, p-value = 6.712e-05
alternative hypothesis: true S is not equal to 0
sample estimates:
           S         varS          tau 
 206.0000000 2644.6666667    0.5571435 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = 3.9863, n = 31, p-value = 6.712e-05
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0.00000e+00 1.65529e-06
sample estimates:
 Sen's slope 
7.765558e-07 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 228, p-value = 7.874e-05
alternative hypothesis: two.sided
sample estimates:
probable change point at time K 
                             19 


[[5]]
[[5]]$mean
[1] 0.000000e+00 4.501882e-05

[[5]]$variance
[1] 0.000000e+00 7.645748e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">monthwise_test</span>(<span class="st">"Dec"</span>, <span class="st">"Night"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 33 × 5
    year month period  mean mean_ema
   &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  1979 Dec   Night      0        0
 2  1980 Dec   Night      0        0
 3  1981 Dec   Night      0        0
 4  1982 Dec   Night      0        0
 5  1983 Dec   Night      0        0
 6  1984 Dec   Night      0        0
 7  1985 Dec   Night      0        0
 8  1986 Dec   Night      0        0
 9  1987 Dec   Night      0        0
10  1988 Dec   Night      0        0
# ℹ 23 more rows

[[2]]

    Mann-Kendall trend test

data:  filtered_data$mean_ema
z = NaN, n = 33, p-value = NA
alternative hypothesis: true S is not equal to 0
sample estimates:
   S varS  tau 
   0    0  NaN 


[[3]]

    Sen's slope

data:  filtered_data$mean_ema
z = NaN, n = 33, p-value = NA
alternative hypothesis: true z is not equal to 0
95 percent confidence interval:
 0 0
sample estimates:
Sen's slope 
          0 


[[4]]

    Pettitt's test for single change-point detection

data:  filtered_data$mean_ema
U* = 0, p-value = 1
alternative hypothesis: two.sided
sample estimates:
probable change point at time K                            &lt;NA&gt; 
                              1                               2 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              3                               4 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              5                               6 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              7                               8 
                           &lt;NA&gt;                            &lt;NA&gt; 
                              9                              10 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             11                              12 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             13                              14 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             15                              16 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             17                              18 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             19                              20 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             21                              22 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             23                              24 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             25                              26 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             27                              28 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             29                              30 
                           &lt;NA&gt;                            &lt;NA&gt; 
                             31                              32 
                           &lt;NA&gt; 
                             33 


[[5]]
[[5]]$mean
[1] 0

[[5]]$variance
[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar = c(1, 1, 1, 1))</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># logistic regression for temperature boundary point</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># phase is estimated based on rain ratio.. with greater than 0.5 as 1, and less than 0.5 as 0</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co">#then creating phase column as factor, which is enforced to logistic model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### data for logistic maping</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>summary_log <span class="ot">&lt;-</span> climate_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">temp=</span> <span class="fu">mean</span>(t<span class="fl">.1</span>), </span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">rh=</span> <span class="fu">mean</span>(rh<span class="fl">.1</span>),</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">wind=</span><span class="fu">mean</span>(u<span class="fl">.1</span>), </span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">pp=</span><span class="fu">mean</span>(p<span class="fl">.1</span>),</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">rain_ratio=</span> <span class="fu">mean</span>(phaseCorrectRainRatio),</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">season=</span> <span class="fu">unique</span>(season)) <span class="sc">%&gt;%</span> </span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">phase=</span><span class="fu">as.factor</span>(<span class="fu">ifelse</span>(rain_ratio <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary_log$temp_1 &lt;-  rnorm(9546, 0, 0.01) + summary_log$temp</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="do">##define the model</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>log_regression <span class="ot">&lt;-</span> <span class="fu">glm</span>(phase <span class="sc">~</span>  temp <span class="sc">+</span> rh <span class="sc">+</span> wind, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span> summary_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = phase ~ temp + rh + wind, family = "binomial", 
    data = summary_log)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -19.766061   1.114538 -17.735   &lt;2e-16 ***
temp          2.786350   0.119064  23.402   &lt;2e-16 ***
rh            0.183061   0.009604  19.061   &lt;2e-16 ***
wind         -0.018703   0.046164  -0.405    0.685    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 13106.1  on 9545  degrees of freedom
Residual deviance:  1087.4  on 9542  degrees of freedom
AIC: 1095.4

Number of Fisher Scoring iterations: 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(log_regression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    temp       rh     wind 
2.824468 3.186100 1.373769 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting logistic graph between temp and rainfall fraction </span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_log, <span class="fu">aes</span>(temp, rain_ratio))<span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> season), <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"rainfall ratio"</span>)<span class="sc">+</span> </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.00</span>, <span class="fl">1.00</span>, <span class="at">by =</span> <span class="fl">0.10</span>))<span class="sc">+</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.01</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">'glm'</span>,  <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>))<span class="sc">+</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Temperature °C"</span>)<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Logistic probability"</span>)<span class="sc">+</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plots/logistic.png"</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height=</span> <span class="dv">7</span>, <span class="at">type=</span><span class="st">"cairo"</span>, <span class="at">dpi=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using ragg device as default. Ignoring `type` and `antialias`
arguments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="do">## visual representation of rain-ratio with rall variables</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>visual_relation <span class="ot">&lt;-</span> <span class="cf">function</span>(variable){</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  summary_log <span class="sc">%&gt;%</span> </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>({{variable}}, rain_ratio))<span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> season))<span class="sc">+</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">"glm"</span>,  <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">"binomial"</span>))<span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>( <span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="fu">visual_relation</span>(rh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visual_relation</span>(wind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visual_relation</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visual_relation</span>(pp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pyschrometric_model_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating graph for sample year 2000</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>datetime <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">"1979/01/01"</span>),</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">"2018/12/31"</span>),</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"days"</span>)</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> clone_copy <span class="sc">%&gt;%</span> </span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">phaseCorrectRainRatio=</span> <span class="fu">round</span>(phaseCorrectRainRatio, <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">year=</span> <span class="fu">year</span>(datetime),</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">month=</span> <span class="fu">month</span>(datetime, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">day=</span> <span class="fu">day</span>(datetime),</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">period=</span> <span class="fu">if_else</span>(<span class="fu">hour</span>(datetime)<span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span> <span class="fu">hour</span>(datetime)<span class="sc">&lt;</span> <span class="dv">19</span>, <span class="st">"Day"</span>, <span class="st">"Night"</span>),</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">ifelse</span>( month <span class="sc">&lt;=</span> <span class="st">"Feb"</span>  <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Dec"</span>, <span class="st">"winter"</span>,</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>( month <span class="sc">==</span> <span class="st">"Mar"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Apr"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"May"</span>, <span class="st">"pre_monsoon"</span>,</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(month <span class="sc">==</span> <span class="st">"Oct"</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="st">"Nov"</span>, <span class="st">"post_monsoon"</span>, <span class="st">"monsoon"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(year <span class="sc">!=</span> <span class="dv">2019</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>time_series <span class="ot">&lt;-</span>  data <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarize</span>(<span class="at">rain=</span><span class="fu">sum</span>(phaseCorrectRain), <span class="at">snow=</span> <span class="fu">sum</span>(phaseCorrectSnow), <span class="at">temp=</span> <span class="fu">mean</span>(t<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>ts2 <span class="ot">&lt;-</span> <span class="fu">xts</span>(time_series[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">order.by =</span> datetime)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>ts2_2000 <span class="ot">&lt;-</span> ts2[<span class="st">"2000"</span>]</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>( <span class="st">"plots/rain and snow.tiff"</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( ts2<span class="sc">$</span>rain, <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1979</span>, <span class="dv">2018</span>), <span class="at">col =</span> <span class="st">"#454545"</span>, <span class="at">main =</span> <span class="cn">NA</span>,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis.right =</span> F, <span class="at">ylab =</span> <span class="st">"Precipitation(mm/day)"</span>, <span class="at">grid.col=</span><span class="cn">NA</span>, <span class="at">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ts2<span class="sc">$</span>snow, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="fu">addLegend</span>(<span class="at">legend.loc =</span> <span class="st">"topright"</span>, <span class="at">legend.names =</span> <span class="fu">c</span>(<span class="st">"rainfall"</span>, <span class="st">"snowfall"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#454545"</span>, <span class="dv">4</span>),</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">at =</span> <span class="fu">pretty</span>(ts2_2000<span class="sc">$</span>phaseCorrectSnow.sum), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="fl">1.6</span>)</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="do">############# plot for the sample year</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/rain and snow 2000.tiff"</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts2_2000<span class="sc">$</span>rain, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="fu">xlim</span>(<span class="dv">1979</span>, <span class="dv">2018</span>), <span class="at">col =</span> <span class="st">"#454545"</span>,</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="cn">NA</span>, <span class="at">yaxis.right =</span> F, <span class="at">ylab =</span> <span class="st">"Precipitation(mm/day)"</span>, <span class="at">cex=</span><span class="fl">0.7</span>,</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">grid.col=</span><span class="cn">NA</span>)</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ts2_2000<span class="sc">$</span>snow, <span class="at">col =</span> <span class="dv">4</span>,<span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="fu">addLegend</span>(</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.loc =</span> <span class="st">"topright"</span>,</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.names =</span> <span class="fu">c</span>(<span class="st">"rainfall"</span>, <span class="st">"snowfall"</span>),</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#454545"</span>, <span class="dv">4</span>),</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># month_wise grid plot with 40 lines</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>lines_graph_maker <span class="ot">&lt;-</span> <span class="cf">function</span>(calculate, column, ylabel, legend){</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  monthly_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">calculate</span>({{column}}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>  monthly_data<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">factor</span>(monthly_data<span class="sc">$</span>year)</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>  color_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#0165fc"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span>))(<span class="fu">length</span>(<span class="fu">unique</span>(monthly_data<span class="sc">$</span>year)))</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(monthly_data, <span class="fu">aes</span>(month, mean, <span class="at">group =</span> year, <span class="at">color =</span> year)) <span class="sc">+</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(<span class="fu">as.integer</span>(monthly_data<span class="sc">$</span>year), <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">between</span>(<span class="fu">as.integer</span>(monthly_data<span class="sc">$</span>year), <span class="dv">40</span>, <span class="dv">40</span>), <span class="fl">0.7</span>, <span class="fl">0.2</span>),</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> color_palette) <span class="sc">+</span></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_line(data = monthly_data[1, ], aes(group = year, color = year), size = 2) +</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_line(data = monthly_data[length(monthly_data$year), ], aes(group = year, color = year), size = 2) +</span></span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylabel) <span class="sc">+</span></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> legend, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>plot1  <span class="ot">&lt;-</span> <span class="fu">lines_graph_maker</span>(max,  t<span class="fl">.1</span>,  <span class="st">"Maximum Daily Temperature °C"</span>, <span class="at">legend=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>plot2  <span class="ot">&lt;-</span> <span class="fu">lines_graph_maker</span>(min,  t<span class="fl">.1</span>,  <span class="st">"Minimum Daily Temperature °C"</span>, <span class="at">legend=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>plot3  <span class="ot">&lt;-</span> <span class="fu">lines_graph_maker</span>(mean, rh<span class="fl">.1</span>,  <span class="st">"Relative Humidity (%)"</span>, <span class="at">legend=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>plot4  <span class="ot">&lt;-</span> <span class="fu">lines_graph_maker</span>(mean, u<span class="fl">.1</span>,  <span class="fu">expression</span>(<span class="st">"Wind (ms"</span><span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">")"</span>), <span class="at">legend=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>plot5  <span class="ot">&lt;-</span> <span class="fu">lines_graph_maker</span>(sum,  p<span class="fl">.1</span>,  <span class="st">"Precipitation (mm)"</span>, <span class="at">legend=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/4plots_combined.tiff"</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3, plot4, plot5)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/oneplotwithlegend.tiff"</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines_graph_maker</span>(sum,  p<span class="fl">.1</span>,  <span class="st">"Precipitation (mm/s)"</span>, <span class="at">legend=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"plots/phase_trend_line_graph.tiff"</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines_graph_maker</span>(sum,  phaseCorrectRainRatio,  <span class="st">"Daily Additive Rainfall ratio"</span>, <span class="at">legend=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ####seasonal mathematical measure </span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal &lt;- function(x, y) {</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   filtered_data &lt;- clone_copy  %&gt;% </span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter(season == x &amp;  period==y) %&gt;% </span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_by(year, season, period) %&gt;% </span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     summarize(mean = mean(phaseCorrectRainRatio)) %&gt;% </span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     ungroup() %&gt;% </span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(mean_ema = movavg(mean, n=5, type='e')) </span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(list(filtered_data, mk.test(filtered_data$mean_ema), sens.slope(filtered_data$mean_ema),</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="co">#               pettitt.test(filtered_data$mean_ema), cpt.meanvar(filtered_data$mean_ema, method="AMOC", minseglen = 10)))</span></span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal("monsoon", "Day")</span></span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal("monsoon", "Night")</span></span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('pre_monsoon', "Day")</span></span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('pre_monsoon', "Night")</span></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('post_monsoon', "Day")</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('post_monsoon', "Night")</span></span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('winter', "Day")</span></span>
<span id="cb240-22"><a href="#cb240-22" aria-hidden="true" tabindex="-1"></a><span class="co"># seasonal('winter', "Night")</span></span>
<span id="cb240-23"><a href="#cb240-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb240-24"><a href="#cb240-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ######rain to snow precipitation ration</span></span>
<span id="cb240-25"><a href="#cb240-25" aria-hidden="true" tabindex="-1"></a><span class="co"># volume &lt;- data %&gt;%</span></span>
<span id="cb240-26"><a href="#cb240-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(year) %&gt;% </span></span>
<span id="cb240-27"><a href="#cb240-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(rain = mean(phaseCorrectRain),</span></span>
<span id="cb240-28"><a href="#cb240-28" aria-hidden="true" tabindex="-1"></a><span class="co">#             snow = mean(phaseCorrectSnow)) %&gt;% </span></span>
<span id="cb240-29"><a href="#cb240-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ratio=rain/snow) %&gt;% </span></span>
<span id="cb240-30"><a href="#cb240-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(mean = mean(ratio),</span></span>
<span id="cb240-31"><a href="#cb240-31" aria-hidden="true" tabindex="-1"></a><span class="co">#             lower_ci = quantile(ratio, probs = 0.025),</span></span>
<span id="cb240-32"><a href="#cb240-32" aria-hidden="true" tabindex="-1"></a><span class="co">#             upper_ci = quantile(ratio, probs = 0.975))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>