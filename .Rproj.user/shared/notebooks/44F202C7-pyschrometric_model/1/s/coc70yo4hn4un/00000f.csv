"0","###legend"
"0","colors <- c(""variable_color""= ""blue"", ""weight_color""=""lightblue"", 'abline_color'= 'red')"
"0",""
"0","#prepare graphs"
"0","make_graph <- function(type, variable, weight, xlab, ylab, mkmodel, legend.position=""FALSE"") {"
"0","  plot <- moving_average %>%"
"0","    ggplot(aes(year, {{variable}})) +"
"0","    xlab(xlab) +"
"0","    ylab(ylab) +"
"0","    geom_line(data = moving_average, aes(year, {{weight}}, color = 'col2')) + "
"0","    geom_point(data= moving_average, aes(year, {{weight}}, color= ""col2""))+"
"0","    geom_abline(intercept = coef(mkmodel)[1], slope = coef(mkmodel)[2] ) +"
"0","    theme_bw() +"
"0","    scale_x_continuous(breaks = seq(1979, 2019, by = 10)) +"
"0","    theme(axis.title = element_text(size = 12)) +"
"0","    theme(legend.position = legend.position) +"
"0","    scale_color_manual(values = c('col2' = '#E69F00'))"
"0","  "
"0","  if (identical(type, geom_bar)) {"
"0","    plot <- plot + geom_bar(stat = ""identity"", fill = ""#0072B2"", alpha=0.5)"
"0","  } else {"
"0","    plot <- plot + type(stat = ""identity"", aes(color = ""col1"")) +"
"0","      scale_color_manual(values = c('col1' = '#0072B2', 'col2' = '#E69F00'))"
"0","  }"
"0","  plot <- plot +"
"0","    geom_abline(intercept = coef(mkmodel)[1], slope = coef(mkmodel)[2], color = ""red"")"
"0","  return(plot)"
"0","}"
